
---
date: 2022-08-02 9:02
description: ุญุฏูุซ ุนู ุงูุฏูุณุจุงุชุดููุฌ
title: ุงุฒุงู ูุบุฉ ุงูุจุฑูุฌุฉ ุจุชุฎุชุงุฑ ุงูุงูุจูููุชูุดู ุงูุฎุงุต ุจุงููุงููุดูุฒ
image: postThumps/DispatchStatic.png
tags:  Arabic, Compilers
---

ุงููุนูููุงุช ูู ุงูุชุฏูููุฉ ุฏู ูุชููู ูุดุฑูุญุฉ ุนูู ูุบุฉ ุณูููุชุ ููู ุงูุงุณุงุณูุงุช ุซุงุจุชุฉ ุบุงูุจุง ูู ุงุบูุจ ุงููุบุงุช
ุญุชู ุงูุงู ุงูุง ุจููุฑ ุงุฐุง ุงูุนููุงู ุงูุญุงูู ูู ุงุญุณู ุนููุงู ููุง ููู ูุตู ุงุญุณู ุ 

ุนูุดุงู ุงูุถุญ ุงูุณูุงู ุงููู ุงูุง ุจุญุงูู ุงุฌุงูุจ ุนูููุ ููุชุจ ุดููุฉ ุงูุซูุฉ ููููุง ููุถุญ ุงูุณุคุงูุ ู ูุจุฏุฃ ูู ุงูุงุฌุงุจุฉ

## ุงูู ุงููุดููุฉ ุงููู ุจูููุฑ ูููุง ุ

```
class Animal { 
    func /~ sayYourName() ~/ { 
    print("i'm Animal")
    }
}

class Dog: Animal  { 
    override func /~ sayYourName() ~/ { 
    print("i'm dog")
    }
}
```
ููุง ุงุญูุง ุนูููุง ููุงุณุ ู ุนูููุง Subclass ูููุง ุงุณูู Dogุ ู ูู ุงูุตุจ ููุงุณ ุฏู ุนูููุง ุงูฺคุฑุฑุงูุฏ ููุงููุดู sayYourName
ูุบุงูุฉ ููุง ูููุด ูุดุงูู

```
//Somewhere far away: 
let myAnimal: /ยง Animal ยง/ = Dog()

myAnimal.sayYourName()
}

```
ูู ุงูุชุฑุถูุง ุงูู ุนูุฏู ฺคุงุฑูุจู ููุนู Animal
ู ุงููููุฉ ุงููู ุฌูุงู ูู ุงูุจุฌูุช ูู Dog
ุงูููุฏ ุฏุง ูุธุฑูุง ุดุบุงู ููููููุด ูุดุงููุ ูุฃูู ุงูุณูุจุฑููุงุณ(parent class) ุจุชุงุนุช ุงูDog ูู Animal

ููู ุงูุณุคุงูุ ููุง ูุงูุขุชูุ ุจูุง ุงูู ุงูฺคุงุฑูุจ ุฏุง ููุนู Animalุ ุงููููุจุงููุฑ ุนูุฏู ุฎูุงุฑูู ููุง ุงูุช ุชูุฌู ุชุทูุจ 
sayYourName()

ุงูุฎูุงุฑ ุงูุงููุ ุงูู ูุฎุชุงุฑ ุงูุงูุจูููุชูุดู ุจุชุงุน ุงูุณูุจุฑููุงุณุ ุงู ุจุชุงุน ุงูุตุจููุงุณุ
ููู ุงุตูุง ุนูุฏู ุงูุฎูุงุฑูู ุฏูู ุ ุนูุดุงู ููุน ุงูฺคุงุฑูุจู Animalุ ูุจูุงุก ุนููู ูู ูุด ูุชุฃูุฏ ุงุฐุง ุงููู ุจุนุฏ ุนูุงูุฉ ุงู= ุนุจุงุฑุฉ ุนู ุงูุจุฌูุช ูู ููุงุณ ุนุงููุฉ override ููููุซูุฏ ุจุชุงุนุช sayYourName ููุง ูุง  


ูุซุงู ุขุฎุฑ ุนูู ููุณ ุงูุณุคุงู
```
protocol Player {
  func play()
}

class Messi: Player {
  func play() { print("This's Messi") }
}

class Salah: Player {
  
  func play() {
    print("This's Salah")
  }
}
```
 ุนูุฏู ุจุฑูุชูููู ุจูุงูุฑุ ู ููู ุงูุชุฑ ูู ููุงุณ ุจุชูููููุฑู ูููุ ุฒู ููุงุณ ููุณูุ ู ุตูุงุญุ ููู ูุงุญุฏ ูููู ุนุงูู ุงูุงูุจูููุชูุดู ุจุชุงุน ุจูุงู
 ูุบุงูุฉ ููุง ุงูููุฏ ุฒู ุงููู
 
 ุจุนุฏูู
```
//somewhere far away
let favPlayers: [Player] = [ Messi(), Salah() /* More Players */ ]


for favPlayer in favPlayers {
  // favPlayer type is Player
  favPlayer.play()
}

```
ูู ุฌูุช ูู ููุงู ูุง ุจุนูุฏุ ุนููุช ุงุฑุงูุ ููุนูุง [Player]ุูุนูู ูู ุนุจุงุฑุฉ ุนู ุงุฑุงู ูููู ุชุดูู ุฌูุงูุง ุงู ุงูุจุฌูุช ุจููููููุฑู ูPlayer
ุจุนุฏูู ุนููุช for-loop ุนูู ุงูุงุฑุงู ุฏู ูุนูู ูู ุงููููุช ุฌูุง ุงูุงุฑุงูุ ุนููุช call ูplay

ุงูุณูุงู ููุงุ ุงุฒุงู /ูุบุฉ ุงูุจุฑูุฌุฉ/ุงูุจุฑูุงูุฌุ ุจููุฏุฑ ูุญุฏุฏ ุงูุงูุจูููุชูุดู ุงููู ูุนููู callุ 
ูุฃูู ูููู ุงูุจูุงูุฑ ุงููู ุฌูุง ุงูfor-loop ูููู ููุนู ููุณูุ ุงู ุตูุงุญุ ุงู ููุน ุงุฎุฑุ ูุฏุง ูุด ููุจุงู ุบูุฑ ู ุงูููุฏ ุดุบุงู


ุงูุณุคุงู ุงููู ุงุญูุง ุจููุตูู ููุง ุงุณูู ูู ุงูุจุฑูุฌุฉ
Method Dispatching

> Method dispatch is the algorithm used to decide which method should be invoked in response to a message(function call).

> The goal of dispatch is for the program to tell the CPU where in memory it can find the executable code for a particular method call.

ูุญู ุงููุดููุฉ ุฏู ุงู ุงูุงุฌุงุจุฉ ุนูู ุณุคุงู: ุงุฒุงู ุงููููุจุงููุฑ/ูุบุฉ ุงูุจุฑูุฌุฉ ุจุชุญุฏุฏ ุงูุงูุจูููุชูุดู ุงููู ุชุนููู call ููู ุงูุชุฑ ูู ุทุฑููุฉุ ููู ุทุฑููุฉ ูููุง ูููุฒุงุชูุง ู ุนููุจูุง

### Table Dispatch
ูู ุงูุทุฑููุฉ ุฏูุ ุจูุชู ุนูู ุฌุฏูู ููู ููุงุณ(ุณูุงุก ูุงูุช ุตุจ ููุงุณุฏ ูู ููุงุณ ุงุฎุฑูุ ุงู ูุง)ุ ุงูุฌุฏูู ุฏุง ุจูุญุชูู ุนูู ููุงู ูู ูุงููุดู ูู ุงูููููุฑูุ ูุซุงู ุงูููุฏ ุงูุขุชู ููุชู ุชูููุฏ ุงูุฌุฏุงูู ุฏู ูููุ ุงูุฌุฏุงูู ุจูุชู ุชูููุฏูุง ูู ุงููููุจุงูู ุชุงูู(ูู ุงุบูุจ ุงูุงุญูุงู)

```
class Drawable { 
  func draw() { }
  
  func calculateArea() { }
}


class Line: Drawable { 
  var x1,y1,x2,y2: Double
  

  override func calculateArea() { ... }
  
  func calculateMidPoint() { ... }

}

```

![V-Table](../../postsImages/Dispatching/vtable.png)


ุงูุฌุฏุงูู ุฏู ูุงูู ุงูุง ุชูุซูู ูArray ุจูุชู ุชูููุฏูุงุ ุจุชููู ุงูู ุงูู ุงูุฌุฏุงูู ุฏูุ

<ol>
<li>ุจุงููุณุจุฉ ูููุงุณ Drawable ููู ุชุญุชูู ุนูู ุงุชููู ูุงููุดูุ ู ูู ูุงููุดู ููุฌูุฏ ุฌูุจูุง ุนููุงููุง ูู ุงูููููุฑู</li>

<li>ุจุงููุณุจุฉ ูููุงุณLine ููุชูุงูู ุงูู ุงูุนููุงู ุจุชุงุน ูุงููุดู Draw ูุชุบูุฑุดุ ููู ุ ูุฃููุง ูุนููุชุด ุงูฺคุฑุฑุงูุฏ ููุงูุจูููุชูุดู ุจุชุงุนูุง </li>


<li>ุจุงููุณุจุฉ ูููุงููุดูุฒ ุงููู ุงุชุนูููุง ุงูฺคุฑุฑุงูุฏุ ุฒู CalculateArea ููุชุญุตู ุนูู ุนููุงู ุฌุฏูุฏ</li>

<li>ุจุงููุณุจุฉ ูููุงููุดูุฒ ุงูุฌุฏูุฏุฉ ุชูุงูุง(ูุนูู ูุด ููุฌูุฏ ูู ุงูุณูุจุฑููุงุณ) ูุชุจูู ูุชุถุงูุฉ ูู ุงุฎุฑ ุงูุชูุจู </li>
</ol>

ุงูุฌุฏุงูู ุฏู ูููุฏุฉ ููู ุงุฒุงู ุจุชุณุชุฎุฏู ุ 
ููุง ุชุนูู call ููุงููุดู ุนูู ุงูุจุฌูุช ููุนู Lineุจูุญุตู ุงูุขุชู
ุฎูููุง ูููู ุงูู ุจุนูู ููู ูDraw 


```
let line = Line()
line.calculateArea()

/* 
1. Read the table for the Object 0xB00
2. Read the function pointer at the index for the method. In this case, the method index for calculateArea is 1, so the address (0xB00 + 1) will be read.ยน, 0xB00 represent the start on an array, 
and 1 is the offset to get the needed element (which in this case the the memory address of the needed function implementation)
3. Jump to the address 0x222 



- ยนThe index of each function name is stored in Hash Map/ Dictionary, so at the runtime you can get offset of any function 

- ยนYou can assume that functions are indexed as they appear in the source code/or after being ordered, 
this's an implementation detail and beyond the scope of this article, we may discuss it later., also it varies from languages, some languages use hash tables instead of indices.
*/
```

ุงูููููุช ูู ุงูููุฏ ุจููุถุญ ุงูุฎุทูุงุชุ ููู


<ol>
<li>
 ู ุงูููุฏ ุดุบุงูุ ุจูุฑูุญ ููุชูุจู ุงูุฎุงุต ุจุงูุงูุจุฌูุช(ุงูุชูุจู ุซุงุจุช ููู ุงูุงูุจุฌูุชุณ ูู ููุณ ุงูููุงุณ)
 
</li>

<li>
ุจูุฑูุญ ููุชูุจูุ ู ููููู ุงูุง ุนุงูุฒ ุงููุฐ ุงููุงููุดู ุงููู ุงุณููุง CalculateArea
ุจูุชู ุชุญููููุง ูoffsetุูู ุญุงูุชูุง ุงูoffset ุจุชุงุน ุงููุงููุดู ูกุ ูุจูุงุก ุนููู ุงูุงุฏุฑูุณ ุงููู ููุฑูุญูู ููููู 0xb00 + 1 ููููุงูู  ุฌูุงู ุงูุงุฏุฑูุณ 0x222

ุงูุงุฏุฑูุณ ุฏุง ูู ุงูุงูุจูููุชูุดู ุงููู ุงุญูุง ุนุงูุฒูููุ ุงููู ูู ุงูุงูุจูููุชูุดู ุจุชุงุน CalculateArea.

</li>

<li>
ุงูุณูุณุชู ููุฑูุญ ููุฃุฏุฑูุณ CalculateArea ุงููู ูู 0x222  ููููุฐ ุงูุงูุจูููุชูุดู ุงูููุงุณุจ.


</li>
ุงูุทุฑููุฉ ุฏู ุงุณููุง V-Table dispatch ู ูู ุชุณุชุฎุฏู ูุน ุงูClasses ู ูููุง ุจูุญุตู ูุง ูุณูู ุจ
Runtime Polymorphism
 
 </ol>
 
 
 ### ูููุฒุงุช ุงูTable Dispaching 
 
 
 <ul>
 
 <li>
 โ ุงูุฎุทูุงุช ุจุณูุทุฉ ู ุงุฏุงุฆูุง ูุชููุน: 
 ุงูุงุฏุงุก ูุชููุน ู ุซุงุจุช ูุฃูู ููุง ุชุญุชุงุฌ ุชูุตู ูุฃู ูุงููุดูุ ูุญุชุงุฌ ุงูุงููุณูุช ุจุชุงุนูุง ูุจุนุฏูู ูุชุนูู ุงูุขุชู
 
 <br>
 needed function pointer = Base Address + (offset * function pointer size)

 ูู ุงููุซุงู ุจููุชุฑุถ ุงูู ุงููุงููุดู ุจูููุชุฑ ูก ูุฑุฏุ ูุชูุฏุฑ ุชููู ูู ุตูุงุบุฉ ุงุฎุฑูุ ูุฃูู ุงูุจูููุชุฑุฒ ูุชุฎุฒูุฉ ูู ุงุฑุงูุ ูุฏููุง ุนูุดุงู ุชูุตู ูุฃู ูุงููุดู ูุง ุฏุงู ูุนุงู ุงูุจูููุชุฑ ููููู O (1)
 
 </li>
 </ul>
 
 
 
 #### ุนููุจ ุงูTable Dispatch
 
  
<ul>
 <li>
 ๐๐ป: ููุญุตูู ุนูู ุงู ูุงููุดู ุจูููุชุฑุ ูุญุชุงุฌูู ูุนูู ุฏุง 
 <ol>
 
 <li>
 Read the V- Table Address (Base address) โ Read Instruction
 
  </li>
  
   <li>
Read the address of the pointer (Base Address  + offset) โ Read instruction
 
  </li>
 
    <li>
Go to the address of the function โ Jump instruction  
  </li>
  
 </ol>
 
 ุงูุงูุณุชุฑุงูุดูุฒ ุฏู ุชุนุชุจุฑ ุงูฺคุฑููุฏ ูููู ููุณุชุ ูุฃูู ูู ูุงู ูุนุงู ุงูุจูููุชุฑุ ูููุชุด ูุชุญุชุงุฌ ุชุนูู ูู ุฏุง 
  <li>
  
  ๐๐ป:ยุงูุทุฑููุฉ ุฏู ูุด ูุชุดุชุบู ูุน ุงูุงูุณุชูุดูุฒ ูุฃูู ุงูุงูุณุชูุดูุฒ ุจุชุถูู ูุงููุดูุฒ ุงูุชุฑ ุนูู ุงูููุงุณุ ูููุง ููููู ููู ุชุนููุฏ ุงูุชุฑ ู ุงุญุชูุงุฌ ูุทุฑู ุขุฎุฑู
  </li>
 </ul>

 ## ุงุฒุงู ุจููุตู ููVtable ููุณู 
ูุธู ุงูุณุคุงู ูุงุฆูุ ุงุฒุงู ุงุตูุง ุงูููุฏ ููู ุดุบุงู ุจููุตู ููVtable ุงูุฎุงุต ุจูู ุงูุจุฌูุช  ุ 
ุงูุงุฌุงุจุฉ ููุง ุชููู ูู ููุฏ ุจูุชุนููู ุฌูููุฑูุช ู ุงูุจุฑูุงูุฌ ุจูุชุนูู Compile

ููุซุงูุ ุงูููุฏ ุฏุง ููุง ุจูุชุนููู ูููุจุงููุ ุจูุญุตู ุฌููุฑูุช ููููุฏ ุงููู ุจุนุฏู 


```
class Drawable { func draw() {} }

class Point: Drawable { 

  var x, y: Double
  override func draw() { ... }
  
}

class Line: Drawable { 
  var x1,y1 ,x2, y2: Double

  override func draw() { ... }
}


// Some where far away...

var drawables: [Drawable]
for d in drawables { 
  d.draw()

}
```
ุงูููุฏ ุงููู ุจูุชุนููู ุฌููุฑูุช: 

```
class Drawable { func draw() {} }

class Point: Drawable { 

  var x, y: Double
  override func draw() { ... }
  
}

class Line: Drawable { 
  var x1,y1 ,x2, y2: Double
   /~ var type: LineProperties ~/
  
  override func draw(/~_ self: Line~/) { ... }
}


// Some where far away...

var drawables: [Drawable]
for d in drawables { 
  d./~type.vtable.draw~/(d)

}
```
![V-Table](../../postsImages/Dispatching/vtable2.png)

ุงููู ุจูุญุตู ููุง ุงูู ุงุซูุงุก ุงููููุจุงูููุดู ุจูุชู ุชูููุฏ ฺคุงุฑูุจู type
ู ุงููุงุฑูุจู ุฏุง ุจูุญููู ุฌูุงู ฺคุงุฑูุจู ุงูvtableุ ุงููู ูู ููุง ุจูุดุงูุฑ ุนููู ููู ููููู ุนููู
Base Address
ู ุจุนุฏูู ููุง ุจูุนูู call ูdraw
ุงุญูุง ูุนููุง ุจูุนูููุง ููู ูู ุงูvtableุ ูุจูุงุก ุนููู ุจูุญุชุงุฌ ูุจุงุตู ููุง self

ุงูููุฏ ุจูุชุนููู ุฌููุฑูุช ูู ูุฑุญูุฉ ุจูุชู ุชุญููู ูููุง ููุฏ ุณูููุช ุงููู ููุชูุจ ูููุฏ SIL ููู
Swift intermediate Language
ูุฏู ุนุงูุฒุฉ ููุง ููุงุถูุน ูุชูุฑ ุงุฎุฑู..


### ุงูุฎุชุงู

![V-Table](../../postsImages/Dispatching/vtable3.png)
ุฏู ุตูุฑุฉ ุงุฎุฑู ุจุชูุถุญ ุงูููุธุฑ ูุฃูุชุฑ ูู ุนูุตุฑ ุฌูุง ุงุฑุงูุ ู ุงุฒุงู ูู ุงูุจุฌูุช ุจูุดุงูุฑ ุนูู ุงูVtable
<br>
ููุง ุญุงููุช ุงุชููู ุนู ุทุฑููุฉ ูุงุญุฏุฉ ุจุณ ูู ุทุฑู ุงูDispatchingุ ููู ุทุฑู ุชุงููุฉุ ููููู ูุณุชุฎุฏูุฉ ูู ุณูููุชุ ู ุงูุทุฑู ุฏู ุงุฏุงุฆูุง ุงุญุณู ูู ุงุบูุจ ุงูุงุญูุงูุ ููู ูู ุชุทุฑูุช ููู ุงูุงุฑุชููู ููุจูู ุทููู ุฌุฏุงุ ูููู ุชูุงุตูู ุงูุชุฑ ูู ุงูููุถูุน ุฏุงุ ุฒู ุงูู ุงุญูุง ููุง ุดุฑุญูุง ุงูููุงุณุฒุ ููู ุงูุจุฑูุชูููุงุช ุจูุญุตู ูููุง ุงูู ุ ู ุงุฐุง ุนูููุง ุงูุณุชูุดู ููููุงุณ ุ ูู ุฏู ุชูุงุตูู ุงูุชุฑุ ูุญุงูู ุงุบุทููุง ุงุฐุง ูุฏุฑุช ูู ุชุฏูููุงุช ุงุฎุฑูุ ุงูุงุฑุชููู ุฏุง ูุงู ูุจูุฑุูู ุญุณูุช ุงูู ุนูุฏู ุบูุทุ ุงู ููู ููุทุฉ ูุญุชุงุฌุฉ ุชุชูุถุญ ุงูุชุฑ ุงุชููู ุชูููู..

